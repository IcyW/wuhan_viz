<html>
<head>
    <meta charset="utf-8">
    <title>ECharts</title>
    <!-- 引入 echarts.js -->
    <script src="js/echarts.min.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/china.js"></script>
</head>
<body style="margin: 0px;">
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="width: 100%;height:100%;"></div>
    <script type="text/javascript">
      $.get('data/cities_echart.json', (json) => {option.series[0].data = json; myChart.setOption(option)})
      $.get('data/moves_echart.json', (json) => {option.series[1].data = json; myChart.setOption(option)})

      option = {
          backgroundColor: '#404a59',
          title: {
              text: '确诊病例与武汉人口迁移',
              left: 'center',
              textStyle: {
                  color: '#fff'
              }
          },
          
          tooltip: {
              trigger: 'item',
              formatter:function(params, ticket, callback){
                  if(params.seriesType=="effectScatter") {
                      return params.data.name+": "+params.data.value[2];
                  } else if(params.seriesType=="lines"){
                      return params.data.fromName+" -> " + params.data.toName + ": " + params.data.value;
                  }else{
                      return params.name;
                  }
              }
          },
          legend: {
              show: false,
              orient: 'vertical',
              top: 'bottom',
              left: 'right',
              data: ['地点', '线路'],
              textStyle: {
                  color: '#fff'
              }
          },
          geo: {
              map: 'china',
              label: {
                  emphasis: {
                      show: false
                  }
              },
              roam: true,
              itemStyle: {
                  normal: {
                      areaColor: '#323c48',
                      borderColor: '#404a59'
                  },
                  emphasis: {
                      areaColor: '#2a333d'
                  }
              }
          },
          series: [{
              name: '地点',
              type: 'effectScatter',
              coordinateSystem: 'geo',
              zlevel: 2,
              rippleEffect: {
                  brushType: 'stroke'
              },
              label: {
                  normal: {
                      show: true,
                      position: 'right',
                      formatter: '{b}'
                  },
              },
              symbolSize: 2,
              showEffectOn: 'render',
              itemStyle: {
                  normal: {
                      color: '#46bee9'
                  }
              },
              data: []
          }, {
              name: '线路',
              type: 'lines',
              coordinateSystem: 'geo',
              zlevel: 2,
              large: true,
              effect: {
                  show: true,
                  constantSpeed: 30,
                  symbol: 'pin',
                  symbolSize: 3,
                  trailLength: 0,
              },
              lineStyle: {
                  normal: {
                      color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                          offset: 0, color: '#58B3CC'
                      }, {
                          offset: 1, color: '#F58158'
                      }], false),
                      width: 1,
                      opacity: 0.2,
                      curveness: 0.1
                  }
              },
              data: []
          }]
      };
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    </script>
</body>
</html>
